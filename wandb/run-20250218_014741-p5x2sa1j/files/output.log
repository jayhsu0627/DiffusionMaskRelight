INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 217
INFO:__main__:  Num Epochs = 200
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 16
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 2800
Resuming from checkpoint checkpoint-800
INFO:accelerate.accelerator:Loading states from /sdb5/output_3/checkpoint-800
INFO:accelerate.checkpointing:All model weights loaded successfully
INFO:accelerate.checkpointing:All optimizer states loaded successfully
INFO:accelerate.checkpointing:All scheduler states loaded successfully
INFO:accelerate.checkpointing:All dataloader sampler states loaded successfully
INFO:accelerate.checkpointing:GradScaler state loaded successfully
INFO:accelerate.checkpointing:All random states loaded successfully
INFO:accelerate.accelerator:Loading in 0 custom states
Steps:   5%|██▌                                               | 102/2000 [25:17<7:55:31, 15.03s/it, lr=2.4e-5, step_loss=0.0423]INFO:__main__:5 checkpoints already exist, removing 1 checkpoints
VAE precision: torch.float16
UNet precision: torch.float32
Optimizer dtype: torch.float32
pixel_values dtype: torch.float32
INFO:__main__:removing checkpoints: checkpoint-400
INFO:accelerate.accelerator:Saving current state to /sdb5/output_3/checkpoint-900
Configuration saved in /sdb5/output_3/checkpoint-900/unet/config.json
Model weights saved in /sdb5/output_3/checkpoint-900/unet/diffusion_pytorch_model.safetensors
INFO:accelerate.checkpointing:Optimizer state saved in /sdb5/output_3/checkpoint-900/optimizer.bin
INFO:accelerate.checkpointing:Scheduler state saved in /sdb5/output_3/checkpoint-900/scheduler.bin
INFO:accelerate.checkpointing:Sampler state for dataloader 0 saved in /sdb5/output_3/checkpoint-900/sampler.bin
INFO:accelerate.checkpointing:Gradient scaler state saved in /sdb5/output_3/checkpoint-900/scaler.pt
INFO:accelerate.checkpointing:Random states saved in /sdb5/output_3/checkpoint-900/random_states_0.pkl
INFO:__main__:Saved state to /sdb5/output_3/checkpoint-900
Steps:  10%|████▉                                            | 202/2000 [50:07<7:24:49, 14.84s/it, lr=2.25e-5, step_loss=0.0345]INFO:__main__:5 checkpoints already exist, removing 1 checkpoints
INFO:__main__:removing checkpoints: checkpoint-500
INFO:accelerate.accelerator:Saving current state to /sdb5/output_3/checkpoint-1000
Configuration saved in /sdb5/output_3/checkpoint-1000/unet/config.json
Model weights saved in /sdb5/output_3/checkpoint-1000/unet/diffusion_pytorch_model.safetensors
INFO:accelerate.checkpointing:Optimizer state saved in /sdb5/output_3/checkpoint-1000/optimizer.bin
INFO:accelerate.checkpointing:Scheduler state saved in /sdb5/output_3/checkpoint-1000/scheduler.bin
INFO:accelerate.checkpointing:Sampler state for dataloader 0 saved in /sdb5/output_3/checkpoint-1000/sampler.bin
INFO:accelerate.checkpointing:Gradient scaler state saved in /sdb5/output_3/checkpoint-1000/scaler.pt
INFO:accelerate.checkpointing:Random states saved in /sdb5/output_3/checkpoint-1000/random_states_0.pkl
INFO:__main__:Saved state to /sdb5/output_3/checkpoint-1000
Steps:  11%|█████▌                                           | 226/2000 [56:15<7:29:52, 15.22s/it, lr=2.21e-5, step_loss=0.0287]
