INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 985
INFO:__main__:  Num Epochs = 100
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 16
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 6200
Steps:   0%|                                                                             | 10/6200 [01:51<17:01:13,  9.90s/it, lr=5.4e-7, step_loss=0.662]INFO:__main__:2 checkpoints already exist, removing 1 checkpoints
VAE precision: torch.float16
UNet precision: torch.float32
Trainable VAE precision: torch.float32
Optimizer dtype: torch.float32
pixel_values dtype: torch.float32
INFO:__main__:removing checkpoints: checkpoint-1500
INFO:accelerate.accelerator:Saving current state to /sdb5/output_2/checkpoint-10
Configuration saved in /sdb5/output_2/checkpoint-10/unet/config.json
Model weights saved in /sdb5/output_2/checkpoint-10/unet/diffusion_pytorch_model.safetensors
Configuration saved in /sdb5/output_2/checkpoint-10/vae/config.json
Model weights saved in /sdb5/output_2/checkpoint-10/vae/diffusion_pytorch_model.safetensors
INFO:accelerate.checkpointing:Optimizer state saved in /sdb5/output_2/checkpoint-10/optimizer.bin
INFO:accelerate.checkpointing:Scheduler state saved in /sdb5/output_2/checkpoint-10/scheduler.bin
INFO:accelerate.checkpointing:Sampler state for dataloader 0 saved in /sdb5/output_2/checkpoint-10/sampler.bin
INFO:accelerate.checkpointing:Gradient scaler state saved in /sdb5/output_2/checkpoint-10/scaler.pt
INFO:accelerate.checkpointing:Random states saved in /sdb5/output_2/checkpoint-10/random_states_0.pkl
INFO:__main__:Saved state to /sdb5/output_2/checkpoint-10
Steps:   0%|▏                                                                            | 11/6200 [02:20<26:23:07, 15.35s/it, lr=6.6e-7, step_loss=0.941]Traceback (most recent call last):
  File "/sdb5/DiffusionMaskRelight/train_svd_relight.py", line 1458, in <module>
    main()
  File "/sdb5/DiffusionMaskRelight/train_svd_relight.py", line 1193, in main
    enc_alb = tensor_to_vae_latent(albedos, vae)
  File "/sdb5/DiffusionMaskRelight/train_svd_relight.py", line 255, in tensor_to_vae_latent
    torch.cuda.empty_cache()  # 🚀 Free GPU memory
  File "/opt/conda/envs/DiffLight/lib/python3.10/site-packages/torch/cuda/memory.py", line 218, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
