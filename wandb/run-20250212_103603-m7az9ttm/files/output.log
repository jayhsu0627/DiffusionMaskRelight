INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 985
INFO:__main__:  Num Epochs = 100
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 16
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 6200
Steps:   8%|███████████▉                                                                                                                                        | 500/6200 [2:24:09<27:56:33, 17.65s/it, lr=2.98e-5, step_loss=0.283]INFO:accelerate.accelerator:Saving current state to ./outputs/checkpoint-500
Configuration saved in ./outputs/checkpoint-500/unet/config.json
Model weights saved in ./outputs/checkpoint-500/unet/diffusion_pytorch_model.safetensors
INFO:accelerate.checkpointing:Optimizer state saved in outputs/checkpoint-500/optimizer.bin
INFO:accelerate.checkpointing:Scheduler state saved in outputs/checkpoint-500/scheduler.bin
INFO:accelerate.checkpointing:Sampler state for dataloader 0 saved in outputs/checkpoint-500/sampler.bin
INFO:accelerate.checkpointing:Gradient scaler state saved in outputs/checkpoint-500/scaler.pt
INFO:accelerate.checkpointing:Random states saved in outputs/checkpoint-500/random_states_0.pkl
INFO:__main__:Saved state to ./outputs/checkpoint-500
Traceback (most recent call last):
  File "/sdb5/DiffusionMaskRelight/train_svd_relight.py", line 1219, in <module>
    main()
  File "/sdb5/DiffusionMaskRelight/train_svd_relight.py", line 1182, in main
    del pipeline
UnboundLocalError: local variable 'pipeline' referenced before assignment
